{
  "example1": {
    "post": "pandas pivot_table column names:\n\nFor a dataframe like this:\n\nd = {'id': [1,1,1,2,2], 'Month':[1,2,3,1,3],'Value':[12,23,15,45,34], 'Cost':[124,214,1234,1324,234]}\ndf = pd.DataFrame(d)\n\n     Cost  Month  Value  id\n0    124       1     12   1\n1    214       2     23   1\n2    1234      3     15   1\n3    1324      1     45   2\n4    234       3     34   2\nto which I apply pivot_table\n\ndf2 =    pd.pivot_table(df,\n                        values=['Value','Cost'],\n                        index=['id'],\n                        columns=['Month'],\n                        aggfunc=np.sum,\n                        fill_value=0)\nto get df2:\n\n       Cost            Value\nMonth     1    2     3     1   2   3\nid\n1       124  214  1234    12  23  15\n2      1324    0   234    45   0  34\nis there an easy way to format resulting dataframe column names like\n\nid     Cost1    Cost2     Cost3 Value1   Value2   Value3\n1       124      214      1234    12        23       15\n2      1324       0       234     45         0       34\nIf I do:\n\ndf2.columns =[s1 + str(s2) for (s1,s2) in df2.columns.tolist()]\nI get:\n\n    Cost1  Cost2  Cost3  Value1  Value2  Value3\nid\n1     124    214   1234      12      23      15\n2    1324      0    234      45       0      34\nHow to get rid of the extra level?\n\nthanks!",
    "api": "pandas.pivot_table",
    "discusses_api": "no",
    "thoughts": "No. Because the user asked the question about formatting the column names. The main question is not regarding the API pandas.pivot_table."
  },
  "example2": {
    "post": "define aggfunc for each values column in pandas pivot table:\n\nWas trying to generate a pivot table with multiple \"values\" columns. I know I can use aggfunc to aggregate values the way I want to, but what if I don't want to sum or avg both columns but instead I want sum of one column while mean of the other one. So is it possible to do so using pandas?\n\ndf = pd.DataFrame({\n          'A' : ['one', 'one', 'two', 'three'] * 6,\n          'B' : ['A', 'B', 'C'] * 8,\n          'C' : ['foo', 'foo', 'foo', 'bar', 'bar', 'bar'] * 4,\n          'D' : np.random.randn(24),\n          'E' : np.random.randn(24)\n})\nNow this will get a pivot table with sum:\n\npd.pivot_table(df, values=['D','E'], rows=['B'], aggfunc=np.sum)\nAnd this for mean:\n\npd.pivot_table(df, values=['D','E'], rows=['B'], aggfunc=np.mean)\nHow can I get sum for D and mean for E?\n\nHope my question is clear enough.",
    "api": "pandas.pivot_table",
    "discusses_api": "yes",
    "thoughts": "Yes. Because the user is talking about a specific usage of the aggfunc parameter of the API pandas.pivot_table that they are struggling with."
  }
}